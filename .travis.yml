dist: xenial
language: python
python: 3.7
cache: pip
before_install:
- sudo apt-get update -qq
- sudo apt-get install -qq libxml2-utils
install:
- pip install -r requirements.txt
before_script:
- wget "https://raw.githubusercontent.com/IATI/IATI-Codelists/version-2.03/codelist.xsd"
- wget "https://raw.githubusercontent.com/IATI/IATI-Codelists/version-2.03/xml.xsd"
script:
- flake8 --exclude=pyenv* --ignore E501
- xmllint --schema codelist.xsd --noout xml/*
after_success:
- |
  test $TRAVIS_BRANCH = "master" && \
  curl -s -X POST \
    -H "Content-Type: application/json" \
    -H "Accept: application/json" \
    -H "Travis-API-Version: 3" \
    -H "Authorization: token $TRAVIS_TOKEN" \
    -d "{\"request\": {\"branch\":\"master\"}}" \
    https://api.travis-ci.com/repo/codeforIATI%2Fcodelists/requests
env:
  global:
    secure: a8LiOw9WLnVisAuvt1VzPUsgAoZP2Do3Ehc7WWzgNqWMC7U2WvuImnvciAakWrpmeY3JZcgjS4XXACrl3+6ygPKAjdqZ9OW/zSJvm6jwzY7XdyFU/EQfT1vOtpkaNvls1szevDq+F1Fteokf1Tr2orEJsMpvWQgSOQTmedMOS7gmf7ff1VRqtDBImb2lCZ2/xicoJ7i8uipN1gnKf0TpGNGvIHCW4SumwLJskG9OUlKhTpMXSCsgUg8M9zuBoXJ9Lxg8njYLKhtCYCVp/ocCkZODKoWEwZjIUEagZlwmkczYTQ2NYXlmdJbOTPoS58+KqnKAOvncssoqkC6XXR84wfOTNDl9c4tczyz90uu/xczhUhhIeFZzaBrK1eKKNtl3jFpNxUm0DhrWscL/4tbtieTelmqvkwCA+X6lcXh7Yx8VMY93wxxQSKvQ+VsguxBgYLzjYYv0wh67deHGk+PmjX5Z/dLdlYx6ZAKgblWN+b6kYInVOmGAYiATjovV/HwMD8eTvSEONrjDq1jR21nB0hJhzhT7QbNXStwg8I4WrMfg281XLdLddVPJfvug3lc5qIKnDyYBjUTbHpv/g63CkhRa2NeRYfQZUH0H9hWA5KD+7GQ99FF9kXX9zvqXcCQZWeGbeoicoOHB4LPHhpCYVCofZNYC0tLC++n434kzfJ8=
